<span data-ttu-id="503de-101">Azure Key Vault usa **Azure Active Directory** para autenticar usuarios y aplicaciones que intentan acceder a un almacén.</span><span class="sxs-lookup"><span data-stu-id="503de-101">Azure Key Vault uses **Azure Active Directory** to authenticate users and applications that try to access a vault.</span></span> <span data-ttu-id="503de-102">Para conceder acceso a la aplicación web al almacén, primero necesitamos registrar la aplicación en Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="503de-102">To grant our web application access to the vault, we first need to register our app with Azure Active Directory.</span></span> <span data-ttu-id="503de-103">El registro crea una identidad para la aplicación.</span><span class="sxs-lookup"><span data-stu-id="503de-103">Registering creates an identity for the app.</span></span> <span data-ttu-id="503de-104">Una vez que tenemos una identidad, podemos asignarle permisos para el almacén.</span><span class="sxs-lookup"><span data-stu-id="503de-104">Once we have an identity, we can assign vault permissions to it.</span></span>

<span data-ttu-id="503de-105">Las aplicaciones y los usuarios se autentican en Key Vault con un token de autenticación de Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="503de-105">Apps and users authenticate to Key Vault using an Azure Active Directory authentication token.</span></span> <span data-ttu-id="503de-106">Obtener un token de Azure Active Directory requiere un secreto o certificado, porque cualquier persona que disponga de un token podría usar la identidad de la aplicación para acceder a todos los secretos del almacén.</span><span class="sxs-lookup"><span data-stu-id="503de-106">Getting a token from Azure Active Directory requires a secret or certificate, because anyone with a token could use the application identity to access all of the secrets in the vault.</span></span>

<span data-ttu-id="503de-107">Los secretos de la aplicación están protegidos en el almacén, pero necesitamos mantener un secreto o certificado fuera del almacén para poder acceder a ellos.</span><span class="sxs-lookup"><span data-stu-id="503de-107">Our application secrets are secure in the vault, but we still need to keep a secret or certificate outside of the vault in order to access them!</span></span> <span data-ttu-id="503de-108">Este problema se llama *problema de arranque*, y Azure tiene una solución para él.</span><span class="sxs-lookup"><span data-stu-id="503de-108">This problem is called the *bootstrapping problem*, and Azure has a solution for it.</span></span>

## <a name="managed-service-identity"></a><span data-ttu-id="503de-109">Identidad de servicio administrada</span><span class="sxs-lookup"><span data-stu-id="503de-109">Managed Service Identity</span></span>

<span data-ttu-id="503de-110">*Managed Service Identity* (MSI) es una característica de Azure App Service que la aplicación puede usar para acceder a Key Vault y otros servicios de Azure sin tener que administrar ni un solo secreto.</span><span class="sxs-lookup"><span data-stu-id="503de-110">*Managed Service Identity* (MSI) is a feature of Azure App Service that your app can use to access Key Vault and other Azure services without having to manage even a single secret.</span></span> <span data-ttu-id="503de-111">El uso de MSI es más fácil y seguro que administrar un secreto por su cuenta.</span><span class="sxs-lookup"><span data-stu-id="503de-111">Using MSI is simpler and more secure than managing a secret yourself.</span></span>

<span data-ttu-id="503de-112">Al habilitar MSI, Azure activa un servicio REST de concesión de token independiente para que la aplicación lo use específicamente.</span><span class="sxs-lookup"><span data-stu-id="503de-112">When you enable MSI, Azure activates a separate token-granting REST service specifically for use by your app.</span></span> <span data-ttu-id="503de-113">Cuando la aplicación solicita un token desde el servicio de token de MSI, el servicio se pone en contacto con Azure Active Directory para obtener un token para la identidad de MSI y lo devuelve a la aplicación para usarlo con Key Vault.</span><span class="sxs-lookup"><span data-stu-id="503de-113">When your app requests a token from the MSI token service, the service contacts Azure Active Directory to get a token for the MSI identity and hands it back to your app for use with Key Vault.</span></span> <span data-ttu-id="503de-114">La parte más importante de este flujo de trabajo es la manera en que la aplicación se autentica en el servicio de token de MSI &mdash;; en lugar de requerir un secreto o certificado que necesita para administrar la configuración, la aplicación usa un secreto que Azure inserta de forma segura en su variables de entorno cuando se inicia.</span><span class="sxs-lookup"><span data-stu-id="503de-114">The most important part of this workflow is the way that your app authenticates to the MSI token service &mdash; instead of requiring a secret or certificate you need to manage in your configuration, your app uses a secret that Azure securely injects into its environment variables when it starts up.</span></span> <span data-ttu-id="503de-115">No es necesario administrar ni almacenar el valor de este secreto en ningún lugar.</span><span class="sxs-lookup"><span data-stu-id="503de-115">You don't need to manage or store this secret value anywhere.</span></span> <span data-ttu-id="503de-116">Nada fuera de la aplicación puede acceder a este secreto ni al punto de conexión del servicio de token de MSI.</span><span class="sxs-lookup"><span data-stu-id="503de-116">Nothing outside of your app can access this secret or the MSI token service endpoint.</span></span>

<span data-ttu-id="503de-117">MSI también registra automáticamente la aplicación en Azure Active Directory y eliminará el registro si deshabilita MSI o elimina la aplicación.</span><span class="sxs-lookup"><span data-stu-id="503de-117">MSI also registers your app in Azure Active Directory for you, and will delete the registration if you disable MSI or delete the app.</span></span>

<span data-ttu-id="503de-118">MSI está disponible en todas las ediciones de Azure Active Directory, incluida la edición gratuita incluida con una suscripción de Azure.</span><span class="sxs-lookup"><span data-stu-id="503de-118">MSI is available in all editions of Azure Active Directory, including the Free edition included with an Azure subscription.</span></span> <span data-ttu-id="503de-119">Su uso en App Service no supone ningún costo adicional ni ninguna configuración y, además, se puede habilitar o deshabilitar en una aplicación en cualquier momento.</span><span class="sxs-lookup"><span data-stu-id="503de-119">Using it in App Service has no extra cost and requires no configuration, and it can be enabled or disabled on an app at any time.</span></span>

> [!NOTE]
> <span data-ttu-id="503de-120">MSI no se admite actualmente para aplicaciones web con Linux o Container.</span><span class="sxs-lookup"><span data-stu-id="503de-120">MSI is not currently supported for Linux or Container web apps.</span></span>

<span data-ttu-id="503de-121">Para habilitar MSI se requiere solo un único comando de la CLI de Azure sin ninguna configuración.</span><span class="sxs-lookup"><span data-stu-id="503de-121">Enabling MSI requires only a single Azure CLI command with no configuration.</span></span> <span data-ttu-id="503de-122">Lo haremos en la unidad 5 cuando configuremos una aplicación de App Service y la implementemos en Azure.</span><span class="sxs-lookup"><span data-stu-id="503de-122">We'll do it in unit 5 when we set up an App Service app and deploy to Azure.</span></span> <span data-ttu-id="503de-123">No obstante, antes de eso, vamos a aplicar nuestros conocimientos sobre MSI para escribir el código para la aplicación.</span><span class="sxs-lookup"><span data-stu-id="503de-123">Before that, though, we're going to apply our knowledge of MSI to write the code for our app.</span></span>