<span data-ttu-id="1e4ad-101">Una vez que tenemos una idea de cómo vamos a almacenar los datos en cuentas de almacenamiento, blobs y contenedores, podemos pensar en los recursos de Azure que es necesario crear para admitir la aplicación.</span><span class="sxs-lookup"><span data-stu-id="1e4ad-101">Once we have an idea of how we're going to store data across storage accounts, containers and blobs, we can think about the Azure resources we need to create to support the app.</span></span>

### <a name="storage-accounts"></a><span data-ttu-id="1e4ad-102">Cuentas de almacenamiento</span><span class="sxs-lookup"><span data-stu-id="1e4ad-102">Storage accounts</span></span>

<span data-ttu-id="1e4ad-103">La creación de la cuenta de almacenamiento es una actividad administrativa que tiene lugar antes de implementar y ejecutar la aplicación.</span><span class="sxs-lookup"><span data-stu-id="1e4ad-103">Storage account creation is an administrative/management activity that takes place prior to deploying and running your app.</span></span> <span data-ttu-id="1e4ad-104">Las cuentas se crean normalmente mediante un script de implementación o de configuración del entorno, una plantilla de Azure Resource Manager, o un administrador las crea manualmente.</span><span class="sxs-lookup"><span data-stu-id="1e4ad-104">Accounts are usually created by a deployment or environment setup script, an Azure Resource Manager template, or manually by an administrator.</span></span> <span data-ttu-id="1e4ad-105">Las aplicaciones que no son herramientas administrativas generalmente no tienen permisos para crear cuentas de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="1e4ad-105">Applications other than administrative tools generally should not have permissions to create storage accounts.</span></span>

### <a name="containers"></a><span data-ttu-id="1e4ad-106">Contenedores</span><span class="sxs-lookup"><span data-stu-id="1e4ad-106">Containers</span></span>

<span data-ttu-id="1e4ad-107">A diferencia de la creación de cuentas de almacenamiento, la creación de contenedores es una actividad ligera que tiene sentido realizarla desde dentro de una aplicación.</span><span class="sxs-lookup"><span data-stu-id="1e4ad-107">Unlike storage account creation, container creation is a lightweight activity that makes sense to perform from within an app.</span></span> <span data-ttu-id="1e4ad-108">No es raro que las aplicaciones creen y eliminen contenedores como parte de su trabajo.</span><span class="sxs-lookup"><span data-stu-id="1e4ad-108">It's not uncommon for apps to create and delete containers as part of their work.</span></span>

<span data-ttu-id="1e4ad-109">En el caso de aplicaciones que se basan en un conjunto conocido de contenedores con nombres codificados de forma rígida o preconfigurados, la práctica habitual es permitir que la aplicación cree los contenedores que necesita al inicio o en el primer uso si todavía no existen.</span><span class="sxs-lookup"><span data-stu-id="1e4ad-109">For apps that rely on a known set of containers with hard-coded or preconfigured names, typical practice is to let the app create the containers it needs on startup or first usage if they don't already exist.</span></span> <span data-ttu-id="1e4ad-110">Al permitir que la aplicación cree contenedores en lugar de hacerlo como parte de la implementación de la aplicación se elimina la necesidad de que tanto la aplicación como el proceso de implementación conozcan los nombres de los contenedores que usa la aplicación.</span><span class="sxs-lookup"><span data-stu-id="1e4ad-110">Letting your app create containers instead of doing it as part of your app's deployment eliminates the need for both your application and your deployment process to know the names of the containers the app uses.</span></span>

## <a name="exercise"></a><span data-ttu-id="1e4ad-111">Ejercicio</span><span class="sxs-lookup"><span data-stu-id="1e4ad-111">Exercise</span></span>

<span data-ttu-id="1e4ad-112">Vamos a completar una aplicación de ASP.NET Core sin terminar mediante la adición de código para usar Azure Blob Storage.</span><span class="sxs-lookup"><span data-stu-id="1e4ad-112">We're going to complete an unfinished ASP.NET Core app by adding code to use Azure Blob storage.</span></span> <span data-ttu-id="1e4ad-113">Este ejercicio tiene que ver más con la exploración de la API de Blob Storage que con el diseño de una organización y el esquema de nomenclatura, pero esta es una introducción rápida de la aplicación y cómo almacena los datos:</span><span class="sxs-lookup"><span data-stu-id="1e4ad-113">This exercise is more about exploring the Blob storage API than it is about designing an organization and naming scheme, but here's a quick overview of the app and how it stores data:</span></span>

<span data-ttu-id="1e4ad-114">**Captura de pantalla de lista de tareas de la aplicación, ya que no vamos a verla ejecutada hasta el final**</span><span class="sxs-lookup"><span data-stu-id="1e4ad-114">**TODO screenshot of app, since they're not going to see it run until the end**</span></span>

<span data-ttu-id="1e4ad-115">Nuestra aplicación funciona como una carpeta compartida que acepta cargas de archivos y permite que estén disponibles para su descarga.</span><span class="sxs-lookup"><span data-stu-id="1e4ad-115">Our app works like a shared folder that accepts file uploads and makes them available for download.</span></span> <span data-ttu-id="1e4ad-116">No se usa en su lugar una base de datos para organizar los blobs, se corrigen los nombres de los archivos cargados y se usan directamente como nombres de blob.</span><span class="sxs-lookup"><span data-stu-id="1e4ad-116">It doesn't use a database for organizing blobs &mdash; instead, it sanitizes the names of uploaded files and uses them as blob names directly.</span></span> <span data-ttu-id="1e4ad-117">Todos los archivos cargados se almacenan en un único contenedor.</span><span class="sxs-lookup"><span data-stu-id="1e4ad-117">All uploaded files are stored in a single container.</span></span>

<span data-ttu-id="1e4ad-118">El código con el que comenzaremos se compila y ejecuta, pero las partes responsables de almacenar y cargar los datos están vacías.</span><span class="sxs-lookup"><span data-stu-id="1e4ad-118">The code we'll start with compiles and runs, but the parts responsible for storing and loading data are empty.</span></span> <span data-ttu-id="1e4ad-119">Una vez completado el código, implementaremos la aplicación en Azure App Service y la probaremos.</span><span class="sxs-lookup"><span data-stu-id="1e4ad-119">After we complete the code, we'll deploy the app to Azure App Service and test it.</span></span>

<span data-ttu-id="1e4ad-120">Vamos a configurar la infraestructura de almacenamiento de nuestra aplicación.</span><span class="sxs-lookup"><span data-stu-id="1e4ad-120">Let's set up the storage infrastructure for our app.</span></span>

### <a name="resource-group-and-storage-account"></a><span data-ttu-id="1e4ad-121">Grupo de recursos y cuenta de almacenamiento</span><span class="sxs-lookup"><span data-stu-id="1e4ad-121">Resource group and storage account</span></span>
<span data-ttu-id="1e4ad-122">En primer lugar, crearemos un grupo de recursos que contenga todos los recursos de este ejercicio.</span><span class="sxs-lookup"><span data-stu-id="1e4ad-122">First, we'll create a resource group to contain all of the resources in this exercise.</span></span> <span data-ttu-id="1e4ad-123">Al final lo eliminaremos para limpiar todo lo que creemos.</span><span class="sxs-lookup"><span data-stu-id="1e4ad-123">We'll delete it at the end to clean up everything we create.</span></span> <span data-ttu-id="1e4ad-124">También vamos a crear la cuenta de almacenamiento que nuestra aplicación usará para almacenar los blobs.</span><span class="sxs-lookup"><span data-stu-id="1e4ad-124">We'll also create the storage account our app will use to store blobs.</span></span>

<span data-ttu-id="1e4ad-125">Use el terminal de Azure Cloud Shell para crear el grupo de recursos y la cuenta de almacenamiento mediante la ejecución de los siguientes comandos de la CLI de Azure.</span><span class="sxs-lookup"><span data-stu-id="1e4ad-125">Use the Azure Cloud Shell terminal to create the resource group and storage account by running the following Azure CLI commands.</span></span> <span data-ttu-id="1e4ad-126">Deberá proporcionar un nombre único para la cuenta de almacenamiento; anótelo para usarlo más tarde.</span><span class="sxs-lookup"><span data-stu-id="1e4ad-126">You'll need to provide a unique name for the storage account &mdash; make a note of it for later.</span></span> <span data-ttu-id="1e4ad-127">La elección de `eastus` como ubicación es arbitraria.</span><span class="sxs-lookup"><span data-stu-id="1e4ad-127">The choice of `eastus` for the location is arbitrary.</span></span>

```console
az group create --name blob-exercise-group --location eastus
az storage account create --name <your-unique-storage-account-name> --resource-group blob-exercise-group --location eastus --kind StorageV2
```

<span data-ttu-id="1e4ad-128">**La lista de tareas a continuación deberá ir en el módulo de Azure Storage**</span><span class="sxs-lookup"><span data-stu-id="1e4ad-128">**TODO below should go in Azure Storage module**</span></span>

> [!NOTE]
> <span data-ttu-id="1e4ad-129">¿Por qué`--kind StorageV2`?</span><span class="sxs-lookup"><span data-stu-id="1e4ad-129">Why `--kind StorageV2`?</span></span> <span data-ttu-id="1e4ad-130">Hay unos cuantas clases diferentes de cuentas de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="1e4ad-130">There are a few different kinds of storage accounts.</span></span> <span data-ttu-id="1e4ad-131">En la mayoría de los escenarios, usará cuentas de almacenamiento de fin general v2 (se indica con `StorageV2`).</span><span class="sxs-lookup"><span data-stu-id="1e4ad-131">For most scenarios, you should use general-purpose v2 storage accounts (signified with `StorageV2`).</span></span> <span data-ttu-id="1e4ad-132">El único motivo de que se deban especificar aquí las cuentas de almacenamiento v2 es que todavía son bastante nuevas y aún no son las predeterminadas en Azure Portal o la CLI de Azure.</span><span class="sxs-lookup"><span data-stu-id="1e4ad-132">The only reason v2 storage accounts need to be specified here is that they are still fairly new and have not yet been made the default in the Azure Portal or the Azure CLI.</span></span>

### <a name="container"></a><span data-ttu-id="1e4ad-133">Contenedor</span><span class="sxs-lookup"><span data-stu-id="1e4ad-133">Container</span></span>
<span data-ttu-id="1e4ad-134">La aplicación con la que vamos a trabajar en este módulo usa un único contenedor.</span><span class="sxs-lookup"><span data-stu-id="1e4ad-134">The app we'll be working with in this module uses a single container.</span></span> <span data-ttu-id="1e4ad-135">Vamos a seguir el procedimiento recomendado de dejar que la aplicación cree el contenedor al inicio.</span><span class="sxs-lookup"><span data-stu-id="1e4ad-135">We're going to follow the best practice of letting the app create the container at startup.</span></span> <span data-ttu-id="1e4ad-136">Sin embargo, se puede hacer desde la CLI de Azure: ejecute `az storage container create -h` en el terminal de Cloud Shell si le gustaría ver la documentación.</span><span class="sxs-lookup"><span data-stu-id="1e4ad-136">However, container creation can be done from the Azure CLI: run `az storage container create -h` in the Cloud Shell terminal if you'd like to see the documentation.</span></span>