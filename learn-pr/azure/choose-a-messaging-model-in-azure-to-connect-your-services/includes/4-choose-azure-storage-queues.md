<span data-ttu-id="eff3b-101">Supongamos que va a planear la arquitectura de una aplicación para compartir música.</span><span class="sxs-lookup"><span data-stu-id="eff3b-101">Suppose you are planning the architecture for your music-sharing application.</span></span> <span data-ttu-id="eff3b-102">Debe elegir la opción que le permita garantizar que los archivos de música se carguen en la API web de forma confiable desde la aplicación móvil.</span><span class="sxs-lookup"><span data-stu-id="eff3b-102">You want to choose ensure that music files are uploaded to the web API reliably from the mobile app.</span></span>

<span data-ttu-id="eff3b-103">Una vez haya entendido que esta comunicación debe ser un mensaje, debe elegir si usar las colas de Azure Storage o Service Bus, ya que ambos pueden usarse para almacenar las colas de los mensajes mientras esperan a su procesamiento.</span><span class="sxs-lookup"><span data-stu-id="eff3b-103">Having understood that this communication should be a message, you must choose whether to use Azure Storage queues or Service Bus, both of which can be used to store queues of messages as they await processing.</span></span>

## <a name="delivery-guarantees"></a><span data-ttu-id="eff3b-104">Garantías de entrega</span><span class="sxs-lookup"><span data-stu-id="eff3b-104">Delivery Guarantees</span></span>

<span data-ttu-id="eff3b-105">Los sistemas de colas generalmente garantizan la entrega de cada mensaje de la cola a un componente de destino.</span><span class="sxs-lookup"><span data-stu-id="eff3b-105">Queuing systems usually guarantee delivery of each message in the queue to a destination component.</span></span> <span data-ttu-id="eff3b-106">Sin embargo, estas garantías pueden adoptar enfoques diferentes:</span><span class="sxs-lookup"><span data-stu-id="eff3b-106">However, these guarantees can take different approaches:</span></span>

- <span data-ttu-id="eff3b-107">**Entrega al menos una vez.**</span><span class="sxs-lookup"><span data-stu-id="eff3b-107">**At-Least-Once Delivery.**</span></span> <span data-ttu-id="eff3b-108">En este enfoque, se garantiza que cada mensaje se entregue al menos a uno de los componentes que recuperan los mensajes de la cola.</span><span class="sxs-lookup"><span data-stu-id="eff3b-108">In this approach, each message is guaranteed to be delivered to at least one of the components that retrieve messages from the queue.</span></span> <span data-ttu-id="eff3b-109">Sin embargo, tenga en cuenta que, en determinadas circunstancias, puede que el mismo mensaje se entregue más de una vez.</span><span class="sxs-lookup"><span data-stu-id="eff3b-109">Note, however, that in certain circumstances, it is possible that the same message may be delivered more than once.</span></span> <span data-ttu-id="eff3b-110">Por ejemplo, si hay dos instancias de una aplicación web que recupera mensajes de una cola, normalmente cada mensaje va solo a una de esas instancias.</span><span class="sxs-lookup"><span data-stu-id="eff3b-110">For example, if there are two instances of a web app retrieving messages from a queue, ordinarily each message goes to only one of those instances.</span></span> <span data-ttu-id="eff3b-111">Sin embargo, si una instancia tarda mucho tiempo en procesar el mensaje y se agota el tiempo de espera, puede que el mensaje también se envíe a la otra instancia.</span><span class="sxs-lookup"><span data-stu-id="eff3b-111">However, if one instance takes a long time to process the message, and a time-out expires, the message may be sent to the other instance as well.</span></span> <span data-ttu-id="eff3b-112">El código de la aplicación web debe diseñarse teniendo en mente esta posibilidad.</span><span class="sxs-lookup"><span data-stu-id="eff3b-112">Your web app code should be designed with this possibility in mind.</span></span>
- <span data-ttu-id="eff3b-113">**Entrega como máximo una vez.**</span><span class="sxs-lookup"><span data-stu-id="eff3b-113">**At-Most-Once Delivery.**</span></span> <span data-ttu-id="eff3b-114">En este enfoque, no se garantiza la entrega de cada mensaje y hay muy pocas probabilidades de que no llegue.</span><span class="sxs-lookup"><span data-stu-id="eff3b-114">In this approach, each message is not guaranteed to be delivered and there is a very small chance that it may not arrive.</span></span> <span data-ttu-id="eff3b-115">Sin embargo, no hay posibilidad de que el mensaje se entregue dos veces como en el caso de la entrega al menos una vez.</span><span class="sxs-lookup"><span data-stu-id="eff3b-115">However, there is no chance that the message will be delivered twice as with At-Least-Once delivery.</span></span>
- <span data-ttu-id="eff3b-116">**Primero en caducar primero en salir (FIFO).**</span><span class="sxs-lookup"><span data-stu-id="eff3b-116">**First-In-First-Out (FIFO).**</span></span> <span data-ttu-id="eff3b-117">En la mayoría de los sistemas de mensajería, los mensajes normalmente dejan la cola en el mismo orden en que se agregaron, pero debe considerar si se garantiza este orden.</span><span class="sxs-lookup"><span data-stu-id="eff3b-117">In most messaging system, messages usually leave the queue in the same order in which they were added but you should consider whether this order is guaranteed.</span></span> <span data-ttu-id="eff3b-118">Si la aplicación distribuida requiere que los mensajes se proceden precisamente en el orden correcto, debe elegir un sistema de cola que incluya una garantía FIFO.</span><span class="sxs-lookup"><span data-stu-id="eff3b-118">If your distributed application requires that messages are processed in precisely the correct order, you must choose a queue system that includes a FIFO guarantee.</span></span>

## <a name="transactions"></a><span data-ttu-id="eff3b-119">Transacciones</span><span class="sxs-lookup"><span data-stu-id="eff3b-119">Transactions</span></span>

<span data-ttu-id="eff3b-120">Algunos grupos estrechamente relacionados de mensajes pueden causar problemas cuando se produce un error en la entrega de un mensaje del grupo.</span><span class="sxs-lookup"><span data-stu-id="eff3b-120">Some closely related groups of messages may cause problems when delivery fails for one message in the group.</span></span>

<span data-ttu-id="eff3b-121">Por ejemplo, piense en una aplicación de comercio electrónico.</span><span class="sxs-lookup"><span data-stu-id="eff3b-121">For example, consider an e-commerce application.</span></span> <span data-ttu-id="eff3b-122">Cuando el usuario hace clic en el botón "Comprar", se envía un mensaje con los detalles del pedido junto con un mensaje con los detalles de la tarjeta de crédito.</span><span class="sxs-lookup"><span data-stu-id="eff3b-122">When the user clicks the "Buy" button, a message with the order details is sent along with a message with the credit card details.</span></span> <span data-ttu-id="eff3b-123">Si no se entregó el mensaje de la tarjeta de crédito, puede que el pedido se envíe sin el pago.</span><span class="sxs-lookup"><span data-stu-id="eff3b-123">If the credit card message is not delivered, the order may be dispatched without payment.</span></span>

<span data-ttu-id="eff3b-124">Puede evitar estos tipos de problemas mediante la agrupación de los dos mensajes en una transacción.</span><span class="sxs-lookup"><span data-stu-id="eff3b-124">You can avoid these kinds of problems by grouping the two messages into a transaction.</span></span> <span data-ttu-id="eff3b-125">Las transacciones se realizan correctamente o con errores como una sola unidad.</span><span class="sxs-lookup"><span data-stu-id="eff3b-125">Transactions succeed or fail as a single unit.</span></span> <span data-ttu-id="eff3b-126">Si se produce un error con la entrega del mensaje de los detalles de la tarjeta de crédito, entonces se producirá también con el mensaje de los detalles del pedido.</span><span class="sxs-lookup"><span data-stu-id="eff3b-126">If the credit card details message delivery fails then so will the order details message.</span></span>

## <a name="when-to-use-storage-queues"></a><span data-ttu-id="eff3b-127">Cuándo usar las colas de Storage</span><span class="sxs-lookup"><span data-stu-id="eff3b-127">When to use Storage queues</span></span>

<span data-ttu-id="eff3b-128">Las colas se utilizan para los mensajes pero no para los eventos.</span><span class="sxs-lookup"><span data-stu-id="eff3b-128">Queues are used for messages but not events.</span></span>

<span data-ttu-id="eff3b-129">Las cuentas de Azure Storage incluyen colas, que las aplicaciones distribuidas pueden utilizar como ubicaciones de almacenamiento temporal para los mensajes.</span><span class="sxs-lookup"><span data-stu-id="eff3b-129">Azure Storage Accounts include queues, which can be used by distributed applications as simple temporary storage locations for messages.</span></span> <span data-ttu-id="eff3b-130">Un componente de origen puede agregar un mensaje a la cola.</span><span class="sxs-lookup"><span data-stu-id="eff3b-130">A source component can add a message to the queue.</span></span> <span data-ttu-id="eff3b-131">Los componentes de destino recuperan el mensaje en la parte delantera de la cola para procesarlo.</span><span class="sxs-lookup"><span data-stu-id="eff3b-131">Destination components retrieve the message at the front of the queue for processing.</span></span> <span data-ttu-id="eff3b-132">Dichas colas aumentan la confiabilidad del intercambio de mensajes porque, en los momentos de gran demanda, los mensajes pueden simplemente esperar a que un componente de destino esté listo para procesarlos.</span><span class="sxs-lookup"><span data-stu-id="eff3b-132">Such queues increase the reliability of the message exchange because, at times of high demand, messages can simply wait until a destination component is ready to process them.</span></span>

<span data-ttu-id="eff3b-133">Las colas también se proporcionan como parte de la mensajería de Azure Service Bus.</span><span class="sxs-lookup"><span data-stu-id="eff3b-133">Queues are also provided as part of Azure Service Bus Messaging.</span></span> <span data-ttu-id="eff3b-134">Si ha decidido utilizar una cola de Azure para una comunicación específica, debe decidir si desea utilizar una cola de Storage o una de Service Bus.</span><span class="sxs-lookup"><span data-stu-id="eff3b-134">If you have decided to use a queue in Azure for a specific communication, you must decide whether to use a Storage queue or a Service Bus queue.</span></span>

<span data-ttu-id="eff3b-135">Para realizar esta elección, plantéese estas preguntas:</span><span class="sxs-lookup"><span data-stu-id="eff3b-135">To make this choice, consider the following questions:</span></span>

- <span data-ttu-id="eff3b-136">¿Necesita una garantía de entrega como máximo una vez?</span><span class="sxs-lookup"><span data-stu-id="eff3b-136">Do you need an At-Most-Once delivery guarantee?</span></span>
- <span data-ttu-id="eff3b-137">¿Necesita una garantía FIFO?</span><span class="sxs-lookup"><span data-stu-id="eff3b-137">Do you need a FIFO guarantee?</span></span>
- <span data-ttu-id="eff3b-138">¿Necesita agrupar los mensajes en transacciones?</span><span class="sxs-lookup"><span data-stu-id="eff3b-138">Do you need to group messages into transactions?</span></span>
- <span data-ttu-id="eff3b-139">¿Necesita almacenar mensajes mayores de 64 KB?</span><span class="sxs-lookup"><span data-stu-id="eff3b-139">Do you need to store messages larger than 64KB?</span></span>

<span data-ttu-id="eff3b-140">Si la respuesta a alguna de estas preguntas es afirmativa, debe elegir usar una cola de Service Bus.</span><span class="sxs-lookup"><span data-stu-id="eff3b-140">If the answer to any of these questions is yes, you must choose to use a Service Bus queue.</span></span>

<span data-ttu-id="eff3b-141">Tenga en cuenta además:</span><span class="sxs-lookup"><span data-stu-id="eff3b-141">In addition consider:</span></span>

- <span data-ttu-id="eff3b-142">¿Necesita registros de servidor de todos los mensajes que pasan por la cola?</span><span class="sxs-lookup"><span data-stu-id="eff3b-142">Do you need server-side logs of all messages that pass through the queue?</span></span>
- <span data-ttu-id="eff3b-143">¿Espera que la cola supere el tamaño de 80 GB?</span><span class="sxs-lookup"><span data-stu-id="eff3b-143">Do you expect the queue to exceed 80GB in size?</span></span>

<span data-ttu-id="eff3b-144">Si la respuesta a alguna de estas preguntas es afirmativa, debe elegir usar una cola de Storage.</span><span class="sxs-lookup"><span data-stu-id="eff3b-144">If the answer to any of these questions is yes, you must choose to use a Storage queue.</span></span>

## <a name="summary"></a><span data-ttu-id="eff3b-145">Resumen</span><span class="sxs-lookup"><span data-stu-id="eff3b-145">Summary</span></span>

<span data-ttu-id="eff3b-146">Una cola es una ubicación de almacenamiento temporal simple para los mensajes enviados entre los componentes de una aplicación distribuida.</span><span class="sxs-lookup"><span data-stu-id="eff3b-146">A queue is a simple temporary storage location for messages sent between the components of a distributed application.</span></span> <span data-ttu-id="eff3b-147">Use una cola para organizar el mensaje y controlar correctamente aumentos impredecibles de la demanda.</span><span class="sxs-lookup"><span data-stu-id="eff3b-147">Use a queue to organize message and gracefully handle unpredictable surges in demand.</span></span>

<span data-ttu-id="eff3b-148">Use colas de Azure Storage si desea disponer de un sistema de cola sencillo y fácil de codificar.</span><span class="sxs-lookup"><span data-stu-id="eff3b-148">Use Azure Storage queues when you want a simple and easy-to-code queue system.</span></span> <span data-ttu-id="eff3b-149">Para las necesidades más avanzadas, use las colas de Azure Service Bus.</span><span class="sxs-lookup"><span data-stu-id="eff3b-149">For more advanced needs, use Azure Service Bus queues.</span></span>