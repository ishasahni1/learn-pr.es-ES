<span data-ttu-id="7cc0d-101">El minorista en línea para el que trabaja planea expandirse a una nueva área geográfica en un futuro próximo.</span><span class="sxs-lookup"><span data-stu-id="7cc0d-101">The online retailer that you work for plans to expand to a new geographical area in the near future.</span></span> <span data-ttu-id="7cc0d-102">Esta expansión aumentará su base de clientes y el volumen de transacciones.</span><span class="sxs-lookup"><span data-stu-id="7cc0d-102">This move will increase your customer base and transaction volume.</span></span> <span data-ttu-id="7cc0d-103">Debe asegurarse de que la base de datos está equipada para controlar la expansión cuando sea necesario.</span><span class="sxs-lookup"><span data-stu-id="7cc0d-103">You must ensure that your database is equipped to handle expansion whenever required.</span></span>

<span data-ttu-id="7cc0d-104">Tener una estrategia de partición garantiza que, cuando la base de datos necesite crecer, pueda hacerlo con facilidad y continuar con la realización de consultas y transacciones eficaces.</span><span class="sxs-lookup"><span data-stu-id="7cc0d-104">Having a partition strategy ensures that when your database needs to grow, it can do so easily and continue to perform efficient queries and transactions.</span></span>

## <a name="what-is-a-partition-strategy"></a><span data-ttu-id="7cc0d-105">¿Qué es una estrategia con particiones?</span><span class="sxs-lookup"><span data-stu-id="7cc0d-105">What is a partition strategy?</span></span>

<span data-ttu-id="7cc0d-106">Si continúa agregando nuevos datos a un único servidor o a una sola partición, al final se quedará sin espacio.</span><span class="sxs-lookup"><span data-stu-id="7cc0d-106">If you continue to add new data to a single server or a single partition, it will eventually run out of space.</span></span> <span data-ttu-id="7cc0d-107">Para prepararse para esto, necesita una estrategia de particiones para **escalar horizontalmente** en lugar de verticalmente.</span><span class="sxs-lookup"><span data-stu-id="7cc0d-107">To prepare for this, you need a partitioning strategy to **scale out** instead of up.</span></span> <span data-ttu-id="7cc0d-108">La escalabilidad horizontal permite agregar más particiones a la base de datos a medida que la aplicación las necesita.</span><span class="sxs-lookup"><span data-stu-id="7cc0d-108">Scaling out is also called horizontal scaling, and it enables you to add more partitions to your database as your application needs them.</span></span>

<span data-ttu-id="7cc0d-109">La estrategia de particiones y escalabilidad horizontal de Azure Cosmos DB se controla con la clave de partición, que es un valor que se define al crear una colección.</span><span class="sxs-lookup"><span data-stu-id="7cc0d-109">The partition and scale-out strategy in Azure Cosmos DB is driven by the partition key, which is a value set when you create a collection.</span></span> <span data-ttu-id="7cc0d-110">Una vez establecida la clave de partición, no se puede cambiar sin volver a crear la colección, por lo que la selección de la clave de partición correcta es una decisión importante que tomar al principio del proceso de desarrollo.</span><span class="sxs-lookup"><span data-stu-id="7cc0d-110">Once the partition key is set, it cannot be changed without recreating the collection, so selecting the right partition key is an important decision to make early in your development process.</span></span>  

<span data-ttu-id="7cc0d-111">En esta unidad, obtendrá información sobre cómo elegir una clave de partición que sea adecuada para su escenario y podrá beneficiarse del escalado automático que Azure Cosmos DB puede hacer por usted.</span><span class="sxs-lookup"><span data-stu-id="7cc0d-111">In this unit, you will learn how to choose a partition key that's right for your scenario and will take advantage of the autoscaling that Azure Cosmos DB can do for you.</span></span>

## <a name="partition-key-basics"></a><span data-ttu-id="7cc0d-112">Aspectos básicos de la clave de partición</span><span class="sxs-lookup"><span data-stu-id="7cc0d-112">Partition key basics</span></span>

<span data-ttu-id="7cc0d-113">Una clave de partición representan un valor en la base de datos que se consulta con frecuencia.</span><span class="sxs-lookup"><span data-stu-id="7cc0d-113">A partition key represent a value in your database that's frequently queried.</span></span> <span data-ttu-id="7cc0d-114">Por tanto, en un escenario minorista en línea, es una buena opción usar los valores de Id. de usuario o Id. de producto como la clave de partición.</span><span class="sxs-lookup"><span data-stu-id="7cc0d-114">So in an online retail scenario, using the UserID or ProductID value as the partition key is a good choice.</span></span> <span data-ttu-id="7cc0d-115">El valor de Id. de usuario es una buena elección, ya que la aplicación con frecuencia necesita recuperar la configuración de personalización, el carro de la compra, el historial de pedidos y la información del perfil del usuario, entre otros datos.</span><span class="sxs-lookup"><span data-stu-id="7cc0d-115">UserID is a good choice, as your application frequently needs to retrieve the personalization settings, shopping cart, order history, and profile information for the user, just to name a few.</span></span> <span data-ttu-id="7cc0d-116">El valor de Id. de producto también es una buena opción, ya que la aplicación necesita consultar los niveles de inventario, los costos de envío, las opciones de color, las ubicaciones del almacenamiento y mucho más.</span><span class="sxs-lookup"><span data-stu-id="7cc0d-116">ProductID is also a good choice, as your application needs to query inventory levels, shipping costs, color options, warehouse locations, and more.</span></span>

<span data-ttu-id="7cc0d-117">Una clave de partición debe tener como objetivo la distribución de operaciones en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="7cc0d-117">A partition key should aim to distribute operations across the database.</span></span> <span data-ttu-id="7cc0d-118">Desea distribuir las solicitudes con la intención de evitar particiones activas.</span><span class="sxs-lookup"><span data-stu-id="7cc0d-118">You want to distribute requests in an effort to avoid hot partitions.</span></span> <span data-ttu-id="7cc0d-119">Una partición activa es una única partición que recibe muchas más solicitudes que otras, lo que puede producir un cuello de botella del rendimiento.</span><span class="sxs-lookup"><span data-stu-id="7cc0d-119">A hot partition is a single partition that receives many more requests than the others, which can create a throughput bottleneck.</span></span> <span data-ttu-id="7cc0d-120">Por ejemplo, para la aplicación de comercio electrónico, la hora actual sería una opción poco conveniente para la clave de partición, ya que todos los datos entrantes irían a una única clave de partición.</span><span class="sxs-lookup"><span data-stu-id="7cc0d-120">For example, for your e-commerce application, the current time would be a poor choice of partition key, because all the incoming data would go to a single partition key.</span></span> <span data-ttu-id="7cc0d-121">Resultarían más convenientes los valores de Id. de usuario o Id. de producto, ya que todos los usuarios de su sitio probablemente podrían agregar y actualizar su carro de la compra o la información del perfil prácticamente con la misma frecuencia, lo que distribuye las lecturas y escrituras por todas las particiones de usuario.</span><span class="sxs-lookup"><span data-stu-id="7cc0d-121">UserID or ProductID would be better, as all the users on your site would likely be adding and updating their shopping cart or profile information at about the same frequency, which distributes the reads and writes across all the user partitions.</span></span> <span data-ttu-id="7cc0d-122">Asimismo, las actualizaciones de los datos de productos probablemente también se distribuirán de manera más o menos uniforme, por lo que el valor de Id. de producto resultaría una buena elección como clave de partición.</span><span class="sxs-lookup"><span data-stu-id="7cc0d-122">Likewise, updates to product data would also likely be fairly evenly distributed, making ProductID a good partition key choice.</span></span>

<span data-ttu-id="7cc0d-123">Cada clave de partición tiene un espacio de almacenamiento máximo de 10 GB, que es el tamaño de una partición física en Azure Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="7cc0d-123">Each partition key has a maximum storage space of 10 GB, which is the size of one physical partition in Azure Cosmos DB.</span></span> <span data-ttu-id="7cc0d-124">Por tanto, si el registro único del Id. de usuario o del Id. de producto va a ser mayor que 10 GB, piense en usar una clave compuesta, para que cada registro sea más pequeño.</span><span class="sxs-lookup"><span data-stu-id="7cc0d-124">So if your single UserID or ProductID record is going to be larger than 10 GB, think about using a composite key instead so that each record is smaller.</span></span> <span data-ttu-id="7cc0d-125">Un ejemplo de clave compuesta sería UserID-date, que presentaría un aspecto como CustomerName-08072018.</span><span class="sxs-lookup"><span data-stu-id="7cc0d-125">An example of a composite key would be UserID-date, which would look like CustomerName-08072018.</span></span> <span data-ttu-id="7cc0d-126">Este enfoque de la clave compuesta permitiría crear una partición para cada día que un usuario visite el sitio.</span><span class="sxs-lookup"><span data-stu-id="7cc0d-126">This composite key approach would enable you to create a new partition for each day a user visited the site.</span></span>

## <a name="best-practices"></a><span data-ttu-id="7cc0d-127">Procedimientos recomendados</span><span class="sxs-lookup"><span data-stu-id="7cc0d-127">Best practices</span></span>

<span data-ttu-id="7cc0d-128">Cuando vaya a tratar de determinar la clave de partición correcta y la solución no sea obvia, tenga en cuenta las siguientes sugerencias.</span><span class="sxs-lookup"><span data-stu-id="7cc0d-128">When you're trying to determine the right partition key and the solution isn't obvious, here are a few tips to keep in mind.</span></span>

* <span data-ttu-id="7cc0d-129">No tenga miedo de tener demasiadas claves de partición.</span><span class="sxs-lookup"><span data-stu-id="7cc0d-129">Don’t be afraid of having too many partition keys.</span></span> <span data-ttu-id="7cc0d-130">Mientras más claves de partición tenga, mayor escalabilidad tendrá.</span><span class="sxs-lookup"><span data-stu-id="7cc0d-130">The more partition keys you have, the more scalability you have.</span></span>

* <span data-ttu-id="7cc0d-131">Para determinar la mejor clave de partición para una carga de trabajo de lectura intensiva, revise las tres o cinco primeras consultas que planea usar.</span><span class="sxs-lookup"><span data-stu-id="7cc0d-131">To determine the best partition key for a read-heavy workload, review the top three to five queries you plan on using.</span></span> <span data-ttu-id="7cc0d-132">El valor incluido con más frecuencia en la cláusula WHERE es un buen candidato para la clave de partición.</span><span class="sxs-lookup"><span data-stu-id="7cc0d-132">The value most frequently included in the WHERE clause is a good candidate for the partition key.</span></span>

* <span data-ttu-id="7cc0d-133">Para cargas de trabajo de escritura intensiva, deberá conocer las necesidades transaccionales de la carga de trabajo, porque la clave de partición es el ámbito de las transacciones de varios documentos.</span><span class="sxs-lookup"><span data-stu-id="7cc0d-133">For write-heavy workloads, you'll need to understand the transactional needs of your workload, because the partition key is the scope of multi-document transactions.</span></span>
