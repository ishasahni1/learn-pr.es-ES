<span data-ttu-id="1069a-101">A continuación, consideraremos los datos a través de nuestra base de datos.</span><span class="sxs-lookup"><span data-stu-id="1069a-101">Next we'll consider the data throughout for our database.</span></span> <span data-ttu-id="1069a-102">Esto es importante para asegurarse de que podemos administrar el volumen de transacciones para nuestras necesidades empresariales.</span><span class="sxs-lookup"><span data-stu-id="1069a-102">This is important to ensure we can handle the volume of transactions for our business needs.</span></span> <span data-ttu-id="1069a-103">Los requisitos de rendimiento no siempre son coherentes.</span><span class="sxs-lookup"><span data-stu-id="1069a-103">Throughput requirements aren't always consistent.</span></span> <span data-ttu-id="1069a-104">Por ejemplo, puede crear un sitio web de compras que se deba escalar durante las festividades o las ofertas.</span><span class="sxs-lookup"><span data-stu-id="1069a-104">For example, you may be building a shopping website that needs to scale during sales or holidays.</span></span> <span data-ttu-id="1069a-105">Para comenzar, calcularemos los requisitos de rendimiento de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="1069a-105">We'll start estimating your database throughput requirements.</span></span>

## <a name="what-is-database-throughput"></a><span data-ttu-id="1069a-106">¿Qué es el rendimiento de la base de datos?</span><span class="sxs-lookup"><span data-stu-id="1069a-106">What is database throughput?</span></span> 

<span data-ttu-id="1069a-107">El rendimiento de la base de datos es el número de lecturas y escrituras que la base de datos puede realizar en un solo segundo.</span><span class="sxs-lookup"><span data-stu-id="1069a-107">Database throughput is the number of reads and writes that your database can perform in a single second.</span></span> 

<span data-ttu-id="1069a-108">Para escalar el rendimiento de manera estratégica, debe calcular las necesidades de rendimiento mediante el cálculo del número de lecturas y escrituras que debe admitir en distintos momentos y para distintos tamaños de documento.</span><span class="sxs-lookup"><span data-stu-id="1069a-108">To scale throughput strategically, you need to estimate your throughput needs by estimating the number of reads and writes you'll have to support at different times and for different document sizes.</span></span> <span data-ttu-id="1069a-109">Si calcula correctamente, los usuarios seguirán satisfecho cuando se produzcan aumentos en la demanda.</span><span class="sxs-lookup"><span data-stu-id="1069a-109">If you estimate correctly, you'll keep your users happy when demand spikes.</span></span> <span data-ttu-id="1069a-110">Si calcula de manera incorrecta, las solicitudes se pueden ver limitadas en cuanto a velocidad y las operaciones tendrán que esperar y volver a intentar ejecutarse, lo que probablemente provocará una latencia elevada e insatisfacción en los clientes.</span><span class="sxs-lookup"><span data-stu-id="1069a-110">If you estimate incorrectly, your requests can get rate-limited and operations will have to wait and retry, likely causing high latency and unhappy customers.</span></span>

## <a name="what-is-a-request-unit"></a><span data-ttu-id="1069a-111">¿Qué es una unidad de solicitud?</span><span class="sxs-lookup"><span data-stu-id="1069a-111">What is a request unit?</span></span>

<span data-ttu-id="1069a-112">Azure Cosmos DB mide el rendimiento con lo que se denomina una **unidad de solicitud (RU)**.</span><span class="sxs-lookup"><span data-stu-id="1069a-112">Azure Cosmos DB measures throughput using something called a **request unit (RU)**.</span></span> <span data-ttu-id="1069a-113">El uso de la unidad de solicitud se mide por segundo, por lo que la unidad de medida es **unidades de solicitud por segundo (RU/s)**.</span><span class="sxs-lookup"><span data-stu-id="1069a-113">Request unit usage is measured per second, so the unit of measure is **request units per second (RU/s)**.</span></span> <span data-ttu-id="1069a-114">Debe reservar el número de RU/s que desea que Azure Cosmos DB aprovisione por adelantado, para que pueda administrar la carga que se calculó, y puede escalar o reducir verticalmente las RU/s en cualquier momento para satisfacer la demanda en curso.</span><span class="sxs-lookup"><span data-stu-id="1069a-114">You must reserve the number of RU/s you want Azure Cosmos DB to provision in advance, so it can handle the load you've estimated, and you can scale your RU/s up or down at any time to meet current demand.</span></span>

## <a name="request-unit-basics"></a><span data-ttu-id="1069a-115">Conceptos básicos de unidad de solicitud</span><span class="sxs-lookup"><span data-stu-id="1069a-115">Request unit basics</span></span>

<span data-ttu-id="1069a-116">Una unidad de solicitud única, 1 RU, es equivalente al costo aproximado de realizar una solicitud GET en un documento de 1 KB con el identificador de un documento.</span><span class="sxs-lookup"><span data-stu-id="1069a-116">A single request unit, 1 RU, is equal to the approximate cost of performing a single GET request on a 1-KB document using a document's ID.</span></span> <span data-ttu-id="1069a-117">Realizar una operación GET mediante el uso del identificador de un documento es un medio eficaz para recuperar un documento y, por tanto, el costo es pequeño.</span><span class="sxs-lookup"><span data-stu-id="1069a-117">Performing a GET by using a document's ID is an efficient means for retrieving a document, and thus the cost is small.</span></span> <span data-ttu-id="1069a-118">Crear, reemplazar o eliminar el mismo elemento requiere que el servicio lleve a cabo un procesamiento adicional y, por tanto, requiere más unidades de solicitud.</span><span class="sxs-lookup"><span data-stu-id="1069a-118">Creating, replacing, or deleting the same item requires additional processing by the service, and therefore requires more request units.</span></span>

<span data-ttu-id="1069a-119">El número de unidades de solicitud que se usa para una operación cambia según el tamaño del documento, el número de propiedades en el documento, la operación que se realiza y algunos conceptos adicionales complejos, como la coherencia y la directiva de indexación.</span><span class="sxs-lookup"><span data-stu-id="1069a-119">The number of request units used for an operation changes depending on the document size, the number of properties in the document, the operation being performed, and some additional complex concepts such as consistency and indexing policy.</span></span>

<span data-ttu-id="1069a-120">En la tabla siguiente se muestra el número de unidades de solicitud que se necesita para elementos de tres tamaños diferentes (1 KB, 4 KB y 64 KB) y en dos niveles de rendimiento distintos (500 lecturas/segundo + 100 escrituras/segundo y 500 lecturas/segundo + 500 escrituras/segundo).</span><span class="sxs-lookup"><span data-stu-id="1069a-120">The following table shows the number of request units required for items of three different sizes (1 KB, 4 KB, and 64 KB) and at two different performance levels (500 reads/second + 100 writes/second and 500 reads/second + 500 writes/second).</span></span> <span data-ttu-id="1069a-121">En este ejemplo, la coherencia de datos se establece en **Sesión**, y la directiva de indexación se establece en **Ninguna**.</span><span class="sxs-lookup"><span data-stu-id="1069a-121">In this example, the data consistency is set to **Session**, and the indexing policy is set to **None**.</span></span>

| <span data-ttu-id="1069a-122">Tamaño del elemento</span><span class="sxs-lookup"><span data-stu-id="1069a-122">Item size</span></span> | <span data-ttu-id="1069a-123">Lecturas/segundo</span><span class="sxs-lookup"><span data-stu-id="1069a-123">Reads/second</span></span> | <span data-ttu-id="1069a-124">Escrituras/segundo</span><span class="sxs-lookup"><span data-stu-id="1069a-124">Writes/second</span></span> | <span data-ttu-id="1069a-125">Unidades de solicitud</span><span class="sxs-lookup"><span data-stu-id="1069a-125">Request units</span></span>
| --- | --- | --- | --- |
| <span data-ttu-id="1069a-126">1 KB</span><span class="sxs-lookup"><span data-stu-id="1069a-126">1 KB</span></span> | <span data-ttu-id="1069a-127">500</span><span class="sxs-lookup"><span data-stu-id="1069a-127">500</span></span> | <span data-ttu-id="1069a-128">100</span><span class="sxs-lookup"><span data-stu-id="1069a-128">100</span></span> | <span data-ttu-id="1069a-129">(500 * 1) + (100 * 5) = 1000 RU/s</span><span class="sxs-lookup"><span data-stu-id="1069a-129">(500 * 1) + (100 * 5) = 1,000 RU/s</span></span>
| <span data-ttu-id="1069a-130">1 KB</span><span class="sxs-lookup"><span data-stu-id="1069a-130">1 KB</span></span> | <span data-ttu-id="1069a-131">500</span><span class="sxs-lookup"><span data-stu-id="1069a-131">500</span></span> | <span data-ttu-id="1069a-132">500</span><span class="sxs-lookup"><span data-stu-id="1069a-132">500</span></span> | <span data-ttu-id="1069a-133">(500 * 1) + (500 * 5) = 3000 RU/s</span><span class="sxs-lookup"><span data-stu-id="1069a-133">(500 * 1) + (500 * 5) = 3,000 RU/s</span></span>
| <span data-ttu-id="1069a-134">4 KB</span><span class="sxs-lookup"><span data-stu-id="1069a-134">4 KB</span></span> | <span data-ttu-id="1069a-135">500</span><span class="sxs-lookup"><span data-stu-id="1069a-135">500</span></span> | <span data-ttu-id="1069a-136">100</span><span class="sxs-lookup"><span data-stu-id="1069a-136">100</span></span> | <span data-ttu-id="1069a-137">(500 * 1,3) + (100 * 7) = 1350 RU/s</span><span class="sxs-lookup"><span data-stu-id="1069a-137">(500 * 1.3) + (100 * 7) = 1,350 RU/s</span></span>
| <span data-ttu-id="1069a-138">4 KB</span><span class="sxs-lookup"><span data-stu-id="1069a-138">4 KB</span></span> | <span data-ttu-id="1069a-139">500</span><span class="sxs-lookup"><span data-stu-id="1069a-139">500</span></span> | <span data-ttu-id="1069a-140">500</span><span class="sxs-lookup"><span data-stu-id="1069a-140">500</span></span> | <span data-ttu-id="1069a-141">(500 * 1,3) + (500 * 7) = 4150 RU/s</span><span class="sxs-lookup"><span data-stu-id="1069a-141">(500 * 1.3) + (500 * 7) = 4,150 RU/s</span></span>
| <span data-ttu-id="1069a-142">64 KB</span><span class="sxs-lookup"><span data-stu-id="1069a-142">64 KB</span></span> | <span data-ttu-id="1069a-143">500</span><span class="sxs-lookup"><span data-stu-id="1069a-143">500</span></span> | <span data-ttu-id="1069a-144">100</span><span class="sxs-lookup"><span data-stu-id="1069a-144">100</span></span> | <span data-ttu-id="1069a-145">(500 * 10) + (100 * 48) = 9800 RU/s</span><span class="sxs-lookup"><span data-stu-id="1069a-145">(500 * 10) + (100 * 48) = 9,800 RU/s</span></span>
| <span data-ttu-id="1069a-146">64 KB</span><span class="sxs-lookup"><span data-stu-id="1069a-146">64 KB</span></span> | <span data-ttu-id="1069a-147">500</span><span class="sxs-lookup"><span data-stu-id="1069a-147">500</span></span> | <span data-ttu-id="1069a-148">500</span><span class="sxs-lookup"><span data-stu-id="1069a-148">500</span></span> | <span data-ttu-id="1069a-149">(500 * 10) + (500 * 48) = 29 000 RU/s</span><span class="sxs-lookup"><span data-stu-id="1069a-149">(500 * 10) + (500 * 48) = 29,000 RU/s</span></span>
 
<span data-ttu-id="1069a-150">Como puede ver, cuanto mayor sea el elemento y cuantas más lecturas y escrituras se necesiten, más unidades de solicitud debe reservar.</span><span class="sxs-lookup"><span data-stu-id="1069a-150">As you can see, the larger the item is, and the more reads and writes are required, the more request units you need to reserve.</span></span> <span data-ttu-id="1069a-151">Si tiene que calcular las necesidades de rendimiento de una aplicación, Azure Cosmos DB [Capacity Planner](https://www.documentdb.com/capacityplanner) es una herramienta en línea que le permite cargar un documento JSON de ejemplo y establecer el número de operaciones que necesita completar por segundo.</span><span class="sxs-lookup"><span data-stu-id="1069a-151">If you need to estimate the throughput needs of an application, the Azure Cosmos DB [Capacity Planner](https://www.documentdb.com/capacityplanner) is an online tool that enables you to upload a sample JSON document and set the number of operations you need to complete per second.</span></span> <span data-ttu-id="1069a-152">Luego proporciona un total estimado que se debe reservar.</span><span class="sxs-lookup"><span data-stu-id="1069a-152">It then provides an estimated total to reserve.</span></span>

## <a name="exceeding-throughput-limits"></a><span data-ttu-id="1069a-153">Superación de los límites de rendimiento</span><span class="sxs-lookup"><span data-stu-id="1069a-153">Exceeding throughput limits</span></span>

<span data-ttu-id="1069a-154">Si no reserva unidades de solicitud suficientes e intenta leer o escribir más datos de los que permite el rendimiento aprovisionado, se limitará la velocidad de la solicitud.</span><span class="sxs-lookup"><span data-stu-id="1069a-154">If you don’t reserve enough request units, and you attempt to read or write more data than your provisioned throughput allows, your request will be rate-limited.</span></span> <span data-ttu-id="1069a-155">Cuando se limita la velocidad de una solicitud, esta se debe volver a intentar después de un intervalo especificado.</span><span class="sxs-lookup"><span data-stu-id="1069a-155">When a request is rate-limited, the request has to be retried again after a specified interval.</span></span> <span data-ttu-id="1069a-156">Si usa el SDK .NET, la solicitud se reintentará automáticamente después de esperar el período de tiempo especificado en el encabezado retry-after.</span><span class="sxs-lookup"><span data-stu-id="1069a-156">If you use the .NET SDK, the request will be retried automatically after waiting the amount of time specified in the retry-after header.</span></span>

## <a name="creating-an-account-built-to-scale"></a><span data-ttu-id="1069a-157">Creación de una cuenta creada para escalar</span><span class="sxs-lookup"><span data-stu-id="1069a-157">Creating an account built to scale</span></span>

<span data-ttu-id="1069a-158">Puede cambiar el número de unidades de solicitud aprovisionadas en una base de datos en cualquier momento.</span><span class="sxs-lookup"><span data-stu-id="1069a-158">You can change the number of request units provisioned to a database at any time.</span></span> <span data-ttu-id="1069a-159">Por tanto, durante los períodos de gran volumen, puede escalar verticalmente para dar cabida a esas altas demandas y luego reducir el rendimiento aprovisionado durante las horas de menor actividad para reducir los costos.</span><span class="sxs-lookup"><span data-stu-id="1069a-159">So, during heavy volume periods, you can scale up to accommodate those high demands, and then reduce provisioned throughput during off peak times to reduce costs.</span></span>

<span data-ttu-id="1069a-160">Cuando crea una cuenta, puede aprovisionar un mínimo de 400 RU/s o un máximo de 250 000 RU/s en el portal.</span><span class="sxs-lookup"><span data-stu-id="1069a-160">When you create an account, you can provision a minimum of 400 RU/s, or a maximum of 250,000 RU/s in the portal.</span></span> <span data-ttu-id="1069a-161">Si necesita más rendimiento, rellene una incidencia en Azure Portal.</span><span class="sxs-lookup"><span data-stu-id="1069a-161">If you need even more throughput, fill out a ticket in the Azure portal.</span></span> <span data-ttu-id="1069a-162">Se recomienda establecer el rendimiento inicial en 1000 RU/s para casi todas las cuentas, ya que es el valor mínimo en el que la base de datos realizará el escalado automático si necesita más de 10 GB de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="1069a-162">Setting the initial throughput to 1000 RU/s is recommended for almost all accounts, as it is the minimum value in which your database will autoscale should you need more than 10 GB of storage.</span></span> <span data-ttu-id="1069a-163">Si establece el rendimiento inicial en cualquier valor menor que 1000 RU/s, la base de datos no podrá escalar a más de 10 GB, a menos que vuelva a aprovisionar la base de datos y proporcione una clave de partición.</span><span class="sxs-lookup"><span data-stu-id="1069a-163">If you set the initial throughput to any value less than 1000 RU/s, your database will not be able to scale to larger than 10 GB unless you reprovision the database and provide a partition key.</span></span> <span data-ttu-id="1069a-164">Las claves de partición habilitan la búsqueda rápida de datos en Azure Cosmos DB y permiten que escale automáticamente la base de datos cuando sea necesario.</span><span class="sxs-lookup"><span data-stu-id="1069a-164">Partition keys enable quick lookup of data in Azure Cosmos DB and enable it to autoscale your database when needed.</span></span> <span data-ttu-id="1069a-165">Las claves de partición se describen en la unidad siguiente.</span><span class="sxs-lookup"><span data-stu-id="1069a-165">Partition keys are discussed in the next unit.</span></span>

## <a name="summary"></a><span data-ttu-id="1069a-166">Resumen</span><span class="sxs-lookup"><span data-stu-id="1069a-166">Summary</span></span>

<span data-ttu-id="1069a-167">Ahora ya sabe cómo calcular y examinar el rendimiento para Azure Cosmos DB mediante las unidades de solicitud.</span><span class="sxs-lookup"><span data-stu-id="1069a-167">You now understand how to estimate and scope throughput for an Azure Cosmos DB using request units.</span></span> <span data-ttu-id="1069a-168">Las unidades de solicitud se pueden modificar en cualquier momento y establecerlas en 1000 RU/s cuando se crea una cuenta ayuda a garantizar que la base de datos está lista para escalar más adelante.</span><span class="sxs-lookup"><span data-stu-id="1069a-168">Request units can be modified at any time, and setting them to 1000 RU/s when you create an account helps ensure your database is ready to scale later.</span></span>